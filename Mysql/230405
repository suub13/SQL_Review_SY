# mysql 데이터베이스의 user 테이블
-- desc mysql.user; #얘를 기준으로 해서 실행행 user는 table, desc = describe

# 위와 동일
-- show columns from mysql.user; 
show full columns from mysql.user; # 권한 등에  대한 내용이 추가 되었음.

# select 문
select user
	  ,host
      from mysql.user -- Database
;

# DDL (Data Definition Language) 
# 사용자 생성 (이름 = test, 비밀번호 = 1234, 접속 범위 = localhost)
# localhost = ip또한 확인해 준다.
CREATE USER 'test'@'localhost'IDENTIFIED BY'1234';
SELECT user, host from mysql.user;

-- host에 '%' 값을 넣게되면 어떤 IP라도 접속이 가능합니다.
CREATE user 'anywhere'@'%' identified by '1234'; 
select user, host from mysql.user;

-- # 특정 ip에서만 접근 가능 
create user 'test2'@'192.168.0.%' identified by '1234';
select user, host from mysql.user;

-- # create or replace -> 이미 존재하는 사용자일 경우 주어진 값으로 replace한다.
CREATE or REPLACE user 'test'@'localhost' IDENTIFIED BY '1234';
SELECT USER, HOST FROM MYSQL.USER;

-- # 생성하고자 하는 사용자 이름이 이미 사용중이지 않을 때만 생성
create user if not exists 'test'@'localhost' identified by '1234';
SELECT USER, HOST FROM MYSQL.USER;

# 사용자의 데이터를 변경
rename user 'test2'@'192.168.0.%' to 'test3'@'%';
SELECT USER, HOST FROM MYSQL.USER;

# 사용자의 비밀번호를 변경
set password for 'test3'@'%' = password('12345');
SELECT USER, HOST FROM MYSQL.USER;

# 사용자를 삭제
-- drop user 'test3'@'%';
-- SELECT USER, HOST FROM MYSQL.USER;

# 조걱에 따라 해당 사용자가 존재할 때 삭제
drop user if exists 'anywhere'@'%';
SELECT USER, HOST FROM MYSQL.USER;

# 데이터베이스 생성하기
create database test;

# 권한 조회하기
show grants for 'test'@'localhost';

# 데이터베이스 권한 부여하기  test.* -> test라는 모든 부분에서 
grant all privileges on test.* to 'test'@'localhost';
flush privileges;

# 권한 삭제하기
revoke all on test.* from 'test'@'localhost';
flush privileges;

# database의 목록을 조회하기
show databases;

# 특수한 문자를 포함하는 database 생성
create database `test.test`;
show databases;

# database 삭제
drop database `test.test`;
show databases;


create database test1;

create database java;
show databases; 

#지금부터 자바라는 데이터베이스에 대해 사용하겠다.
# 데이터 베이스를 생략해도 java에서 찾아라.
use java;

# varchar = 가변형 문자열을 같은 자료형
create Table table1(column1 varchar(100));

# 테이블 목록 조회
show tables;

# 지금 use되고 있는 데이터베이스를 조회 
select database();

# 테이블 이름 변경
rename table table1 to table2;
show tables; -- 이름 바뀜을 확인
# 테이블 제거
drop table table2;
show tables; -- 아무것도 없음을 확인

# 테이블 열에 대해 수정을 할 테이블 생성
create table test_table(
	test_column1 int,
    test_column2 int,
    test_column3 int
);
desc test_table;

# 테이블에 column 추가하기
alter table test_table add test_column4 int;
desc test_table;

# 여러 개의 컬럼을 동시에 추가하기
alter table test_table add(test_column5 int, test_column6 int, test_column7 int);
desc test_table;

# 테이블에 column삭제 테이블 안 데이터를 바꾸려면 alter를 해야한다.
alter table test_table drop test_column5;
desc test_table;

# 테이블 컬럼들 간의 순서를 바꾸기
alter table test_table modify test_column4 int first;
desc test_table;

# 특정 위치로 컬럼 순서 변경하기
# 특정 table 뒤로 보내기
alter table test_table modify test_column7 int after test_column4;
desc test_table;

# 컬럼의 이름 변경하기
alter table test_table change test_column1 test_column0 int;
desc test_table;

# 컬럼의 타입 변경하기
alter table test_table change test_column0 test_column0 varchar(100);
desc test_table;

# 컬럼의 타입과 이름을 동시에 변경
alter table test_table change test_column0 test_column1 int;
desc test_table;

# auto_increment로 자동으로 증가하는 column 만들기 
CREATE TABLE test(id INT auto_increment primary key); -- primary key 적지 않으면 error 발생
show tables;
desc test;

# auto_increment로 지정된 컬럼은 데이터를 지정하지 않아도 된다.
# 데이터를 삽입: value뒤에 오는 소괄호에 데이터를 넣어줘야 합니다.
insert into test value(); -- 이거 돌리는 만큼 데이터가 들어간다

select * from test;
desc test;

# 값을 지정해서 auto_increment 컬럼에 데이터 삽입
insert into test value(100);
insert into test value(); -- 101 이 들어감
insert into test value(22); 
insert into test value(); -- 앞에 22가 들어갔지만 다음은 23이 아닌 102가 들어간다

# 마지막 값을 삭제하고 auto로 데이터를 넣어보기
delete from test where id = 102;
select * from test;

insert into test value(); -- 103이 추가 된다. 삭제한 값이랑 상관없다.
select * from test;

# test 테이블의 모든 데이터 지우기
delete from test; -- 위험하다.

select database();
use java;
select * from test;
delete from test;
select * from test;
insert into test value();

# auto increment 가 1부터 시작하려면 데이터가 아얘 없어야 한다.
delete from test;
select * from test;
show table status where name = 'test';
 
# auto 값의 시작점을 바꿔줌
Alter table test auto_increment = 1;
show table status where name = 'test';

# auto_increment 컬럼의 값을 1부터 모두 연속되게 수정하기
set @count = 0;
update test set id = @count := @count+1;
select * from test;

